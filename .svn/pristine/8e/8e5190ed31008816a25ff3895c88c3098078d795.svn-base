<?php
$this->partial("partials/breadcrumb", [
    'urls'=>['专题列表'=>Url::get('specials/index')],
    'add'=> Url::get('specials/add'),
]);
?>

<div class="table-info table-responsive sortable ui-sortable" id="sorttable">
    <table class="table table-striped table-hover table-bordered">
        <thead>
            <tr>
                <th class="table-checkbox">选择</th>
                <th>标题</th>
                <th>分类</th>
                <th>修改时间</th>
                <th>编辑</th>
                <th>状态</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            <?php
            if (isset($data->models) && !empty($models = $data->models)) :
                foreach ($models as $v) :
                    $cat = $v->privateCategory;
                    ?>
                    <tr>
                        <td class="checkbox-middle"><input type="checkbox" class="checkboxes" value="1"/></td>
                        <td>
                            <img class="small-img" src="<?php if($v->thumb) { echo cdn_url('image',$v->thumb); } else{?> /assets/admin/layout/img/avatar.png<?php } ?>" />
                            <span class="name-center">
                                <?= $v->title ?>
                            </span>
                        </td>
                        <td><?= $cat->name ?></td>
                        <td><?php echo date('Y-m-d H:i:s', $v->specials->updated_at) ?></td>
                        <td><?= $v->author_name ?></td>
                        <td>
                            <span class="<?=  $v->status == 1 ? 'font-green': 'font-red' ?>">
                                <?= ($v->status == 1) ? '已发布' : (($v->status == 0)?'未发布':'待审核') ?>
                            </span>
                        </td>
                        <td>
                            <div class="btn-group btn-group-xs btn-group-solid">
                                <button type="button" class="btn blue-steel href-location tooltips" data-url="<?=Url::get('special_category/index',['id'=>$v->specials->id])?>" data-container="body" data-placement="top" data-trigger="hover" data-html="true" data-original-title="专题分类管理"><i class="fa fa-bar-chart-o"></i></button>
                                <button type="button" class="btn blue href-location tooltips" data-url="/special_templates/index" data-container="body" data-placement="top" data-trigger="hover" data-html="true" data-original-title="专题模板管理"><i class="fa fa-ge"></i></button>
                                <button type="button" class="btn purple href-location tooltips" data-url="<?=Url::get('specials/mediaindex',['id'=>$v->specials->id])?>" data-container="body" data-placement="top" data-trigger="hover" data-html="true" data-original-title="专题媒资管理"><i class="fa fa-database"></i></button>
                                <?php if($checkAuth('specials/edit')){ ?>
                                <button type="button" class="btn green edit-content tooltips" data-url="<?=Url::get('specials/edit',['id'=>$v->specials->id])?>" data-container="body" data-placement="top" data-trigger="hover" data-html="true" data-original-title="编辑"><i class="fa fa-edit"></i></button>
                                <?php }?>
                                <button type="button" class="btn green-jungle edit-content tooltips" data-container="body" data-placement="top" data-trigger="hover" data-html="true" data-url="<?= Url::get('media_posts/publish', ['id' => $v->id]); ?>"
                                data-original-title="<?= $v->status == 1 ? '修改发布栏目': ($v->status == 9 ? '修改发布栏目' : '发布') ?>"><i class="fa
                                <?= $v->status == 1 ? 'fa-pencil': ($v->status == 9 ? 'fa-pencil' : 'fa-send') ?>"></i></button>
                            </div>
                        </td>
                    </tr>
                    <?php
                endforeach;
            endif
            ?>
        </tbody>
    </table>

    <div class="paginationnav">
        <div class="paginationnav-main">
            <div class="table-btn">
                <div class="btn-group">
                    <button type="button" class="btn btn-default group-checkable" data-set="#sorttable .checkboxes">全选</button>
                    <button type="button" class="btn btn-default group-offcheckable" data-set="#sorttable .checkboxes">取消</button>
                    <button type="button" class="btn btn-default group-anticheckable" data-set="#sorttable .checkboxes">反选</button>
                    <button type="button" class="btn btn-default" href="#delet-config" data-toggle="modal">删除</button>
                </div>
            </div>
            <?= $data->pagination->render();?>
                <div class="pagination-info"><?= Lang::_('total') . "： " . $data->count ?></div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $("#sorttable .table").tablesorter({
        headers:{
            0:{sorter:false},
            5:{sorter:false}
        }
    });
</script>