<?php
    $controller = View::getControllerName();
    $r = $controller . "/partials/listmedia_search";
    if (View::exists($r)) {
        $this->partial($r);
    }
?>
<div class="table-info table-responsive sortable" id="sorttable">
    <table class="table table-striped table-hover table-bordered" id="table-list">
        <thead>
        <tr>
            <th title="title">ID</th>
            <th title="title">标题</th>
            <th title="column">栏目</th>
            <th title="operation">操作</th>
        </tr>
        </thead>
        <tbody>
        <?php foreach($parcel->models as $model) {
            $cat = $model->privateCategory;
            $model = $model->data;
            ?>
        <tr>
            <td><?= $model->id;?></td>
            <td>
                <img class="small-img" src="<?php if($model->thumb) {echo cdn_url('image',$model->thumb);} else{?> /assets/admin/layout/img/sidebar_inline_toggler_icon_blue.jpg <?php } ?>"/>
                <a href="javascript:void(0);"><?= h($model->title);?></a>
            </td>
            <td><?=$cat->name;?></td>
            <td>
                <div class="btn-group btn-group-xs btn-group-solid">
                    <button type="button" class="btn blue tooltips" onclick="javascript:import_quote(this, <?= $model->id;?>, '<?= addslashes(h($model->title));?>', '<?= $type;?>');" data-container="body" data-placement="top" data-trigger="hover" data-html="true" data-original-title="引用"><i class="fa fa-chain-broken"></i></button>
                </div>
            </td>
        </tr>
        <?php } ?>
        </tbody>
    </table>

    <div class="paginationnav">
        <div class="paginationnav-main">
            <?= $parcel->pagination->render(); ?>
            <div class="pagination-info">总计 <?= $parcel->count ?> 条</div>
        </div>
    </div>
</div>
<script>
function import_quote(e, i, t, tp) {
    var parentWin=window.opener;
    var data = {id: i, title: t, type: tp};
    console.log(data);
    parentWin.postMessage(data, "*");
    if (e.preventDefault){
        e.preventDefault();
    }
    e.returnValue = false;
    window.parent.close();
}

$("#sorttable .table").tablesorter({
    headers:{
        3:{sorter:false}
    }
});
</script>